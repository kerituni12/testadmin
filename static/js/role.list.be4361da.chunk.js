"use strict";(self.webpackChunkadminn=self.webpackChunkadminn||[]).push([[305],{34135:function(e,n,a){a.r(n),a.d(n,{default:function(){return de}});for(var t,i,r,l,s=a(71171),d=a(96234),o=a(50619),c=a(4844),m=a.n(c),u=a(96370),h=a(49191),x=a(60232),p=a(97875),f=a(22121),v=a(1831),j=a(69896),y=a(54537),g=a(31375),Z=a(34795),k=a(68079),b=a(33028),w=a(2159),I=a(77162),P=a.n(I),C=a(66204),R=a(87846),S=a(48846),N=a(34582),L=a(23683),U=a(48722),W=a(76160),B=a(35070),T=a(96789),z=a(53344),E=a(67778),F=((0,E.Ps)(t||(t=(0,s.Z)(["\n  query Roles {\n    roles {\n      id\n      name\n      role\n      description\n    }\n  }\n"]))),(0,E.Ps)(i||(i=(0,s.Z)(["\n  query Role($where: RoleWhereUniqueInput!) {\n    role(where: $where) {\n      id\n      name\n      role\n      description\n    }\n  }\n"])))),J=a(49135),V=a(4160),q=(0,E.Ps)(r||(r=(0,s.Z)(["\n  query Query($where: PolicyFindByRoleResourceInput!) {\n    z_policyByRoleResource(where: $where) {\n      id\n      effect\n      object\n      action\n      condition\n      effectWith\n    }\n  }\n"]))),D=a(76088),$=(0,E.Ps)(l||(l=(0,s.Z)(["\n  mutation CreatePolicy($data: PolicyCreateInput!) {\n    policy {\n      createPolicy(data: $data)\n    }\n  }\n"]))),G=a(43188),A=["editing","dataIndex","title","inputType","record","index","children"],M=[],O=0;O<10;O++)M.push({id:O.toString(),condition:"r.user.active == true",action:Math.random()<.5?"read":"write",effect:Math.random()<.5?"allow":"deny",effectWith:Math.random()<.5?"own":"any"});var Y,_,K=function(e){var n,a=e.editing,t=e.dataIndex,i=(e.title,e.inputType),r=e.record,l=(e.index,e.children),s=(0,w.Z)(e,A);switch(t){case"action":n=(0,G.jsx)(R.Z.Item,{name:t,initialValue:r.action,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(t,"!")}],children:(0,G.jsx)(z.Z,{options:Q.action,style:{width:"100%"},disabled:!a})});break;case"effectWith":n=(0,G.jsx)(R.Z.Item,{name:t,initialValue:r.effectWith,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(t,"!")}],children:(0,G.jsx)(z.Z,{options:Q.effectWith,style:{width:"100%"},disabled:!a})});break;case"effect":n=(0,G.jsx)(R.Z.Item,{name:t,initialValue:r.effect,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(t,"!")}],children:(0,G.jsx)(S.Z,{disabled:!a,checked:"deny"==r.effect})});break;default:n=(0,G.jsx)(R.Z.Item,{name:t,style:{margin:0},rules:[{max:50,message:"Linit with 50 character"}],children:"number"===i?(0,G.jsx)(N.Z,{}):(0,G.jsx)(p.Z,{})})}return(0,G.jsx)("td",(0,b.Z)((0,b.Z)({},s),{},{children:a?n:l}))},Q={action:[{label:"Create",value:"create"},{label:"Read",value:"read"},{label:"Write",value:"write"},{label:"Delete",value:"delete"}],effectWith:[{label:"Only Owner",value:"own"},{label:"Any",value:"any"}]},H=function(e){var n=e.currentResource,a=e.roleId,t=R.Z.useForm(),i=(0,d.Z)(t,1)[0],r=(0,C.useState)([]),l=(0,d.Z)(r,2),s=l[0],o=l[1],c=(0,C.useState)(""),p=(0,d.Z)(c,2),f=p[0],v=p[1],g=(0,C.useState)(!1),w=(0,d.Z)(g,2),I=w[0],N=w[1],E=(0,J.D)($),F=(0,d.Z)(E,2),D=F[0],A=F[1],M=(0,V.a)(q,{variables:{where:{resource:n,roleId:a}}}),O=M.data,Y=M.loading,_=M.error;if((0,C.useEffect)((function(){O&&o(O.z_policyByRoleResource)}),[O]),Y)return(0,G.jsx)("div",{className:"center-screen",children:(0,G.jsx)(u.Z,{size:"large"})});if(_|A.error)return(0,G.jsx)("h1",{children:"error"});var H=function(e){return e.id===f},X=function(e){o((function(n){v(""),N(!1);var a=n.filter((function(n){return n.id!==e.id}));return a}))},ee=function(){var e=(0,Z.Z)(P().mark((function e(a){var t,r,l,d;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.validateFields();case 3:return t=e.sent,e.next=6,D({variables:{data:{object:n,action:"read",effect:"allow",effectWith:"own",condition:""}}});case 6:r=(0,k.Z)(s),l=r.findIndex((function(e){return a===e.id})),l>-1?(d=r[l],r.splice(l,1,(0,b.Z)((0,b.Z)({},d),t))):r.push(t),o(r),v(""),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("Validate Failed:",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(n){return e.apply(this,arguments)}}(),ne=[{title:"Action",dataIndex:"action",width:"25%",editable:!0,render:function(e){return(0,G.jsx)(z.Z,{defaultValue:e,options:Q.action,style:{width:"100%"},disabled:!0})}},{title:"Effect With",dataIndex:"effectWith",width:"25%",editable:!0,render:function(e){return(0,G.jsx)(z.Z,{defaultValue:e,options:Q.effectWith,style:{width:"100%"},disabled:!0})}},{title:"Deny",dataIndex:"effect",width:"10%",align:"center",editable:!0,render:function(e){return(0,G.jsx)(S.Z,{disabled:!0,defaultChecked:"deny"==e})}},{title:"Condition",dataIndex:"condition",width:"25%",editable:!0},{title:"Operation",dataIndex:"operation",align:"center",render:function(e,n){return H(n)?(0,G.jsxs)("span",{children:[(0,G.jsx)(h.Z.Link,{onClick:function(){return ee(n.id)},style:{marginRight:8},children:"Save"}),(0,G.jsx)(L.Z,{title:"Sure to cancel?",onConfirm:function(){return I?X(n):(i.setFieldsValue({condition:"",action:"",effect:"",effectWith:""}),void v(""))},children:(0,G.jsx)("a",{children:"Cancel"})})]}):(0,G.jsx)(G.Fragment,{children:(0,G.jsxs)(x.Z,{size:"middle",children:[(0,G.jsx)(h.Z.Link,{disabled:""!==f,onClick:function(){return function(e){i.setFieldsValue((0,b.Z)({},e)),v(e.id)}(n)},children:(0,G.jsx)(W.Z,{})}),(0,G.jsx)(h.Z.Link,{disabled:""!==f,onClick:function(){return X(n)},children:(0,G.jsx)(B.Z,{})})]})})}}].map((function(e){return e.editable?(0,b.Z)((0,b.Z)({},e),{},{onCell:function(n){return{record:n,inputType:"age"===e.dataIndex?"number":"text",dataIndex:e.dataIndex,title:e.title,editing:H(n)}}}):e}));return(0,G.jsx)(j.Z,{size:"small",title:(0,G.jsx)(h.Z.Title,{level:4,children:"Policy"}),extra:(0,G.jsx)(y.Z,{size:"small",disabled:""!==f,onClick:function(){o((function(e){var n={id:(e[0].id+"z").toString(),conditon:"",action:"read",effect:"allow",effectWith:"own"};return v(n.id),N(!0),[n].concat((0,k.Z)(e))}))},type:"primary",shape:"circle",children:(0,G.jsx)(T.Z,{})}),bodyStyle:{height:"calc(100vh - 100px - 20px - 48px - 48px - 45px)"},children:(0,G.jsx)(m(),{children:(0,G.jsx)(R.Z,{form:i,component:!1,children:(0,G.jsx)(U.Z,{components:{body:{cell:K}},pagination:!1,size:"small",dataSource:s,columns:ne,rowClassName:"editable-row",rowKey:function(e){return e.id}})})})})},X=a(73391),ee=a(64061),ne=a(59210),ae=a(43955),te=a(9022),ie=a(78225),re=a(37504),le=a(79003);function se(e){var n=e.setCurrentResource;return(0,C.useEffect)((function(){return n("group"),function(){}}),[]),(0,G.jsxs)(ie.Z,{defaultSelectedKeys:["1"],mode:"inline",children:[(0,G.jsx)(ie.Z.Item,{style:{marginTop:0},icon:(0,G.jsx)(X.Z,{}),children:"User"},"1"),(0,G.jsx)(ie.Z.Item,{icon:(0,G.jsx)(ee.Z,{}),children:(0,G.jsx)("p",{onClick:function(){return n("role")},children:"Policy"})},"2"),(0,G.jsx)(ie.Z.Item,{icon:(0,G.jsx)(ne.Z,{}),children:(0,G.jsx)(le.rU,{to:"/dashboard/user/list",children:" User list"})},"3"),(0,G.jsx)(ie.Z.Item,{icon:(0,G.jsx)(ne.Z,{}),children:(0,G.jsx)(le.rU,{to:"/signin".concat("?from="+encodeURIComponent(location.pathname)),children:"Login"})},"33"),(0,G.jsxs)(re.Z,{icon:(0,G.jsx)(ae.Z,{}),title:"Role",children:[(0,G.jsx)(ie.Z.Item,{children:(0,G.jsx)(le.rU,{to:"/dashboard/role/list",children:" Role list"})},"66"),(0,G.jsx)(ie.Z.Item,{children:(0,G.jsx)(le.rU,{to:"/dashboard/role/add",children:" Role add"})},"67"),(0,G.jsx)(ie.Z.Item,{children:"Team 2"},"58")]},"sub2e"),(0,G.jsxs)(re.Z,{icon:(0,G.jsx)(ae.Z,{}),title:"Role",children:[(0,G.jsx)(ie.Z.Item,{children:(0,G.jsx)(le.rU,{to:"/dashboard/role/list",children:" Role list"})},"6s6"),(0,G.jsx)(ie.Z.Item,{children:(0,G.jsx)(le.rU,{to:"/dashboard/role/add",children:" Role add"})},"6s7"),(0,G.jsx)(ie.Z.Item,{children:"Team 2"},"5s8")]},"sub2"),(0,G.jsxs)(re.Z,{icon:(0,G.jsx)(ae.Z,{}),title:"Role",children:[(0,G.jsx)(ie.Z.Item,{children:"Team 1"},"6"),(0,G.jsx)(ie.Z.Item,{children:"Team 2"},"8")]},"role"),(0,G.jsx)(ie.Z.Item,{icon:(0,G.jsx)(te.Z,{}),children:"Files"},"9"),(0,G.jsx)(ie.Z.Item,{icon:(0,G.jsx)(ne.Z,{}),children:(0,G.jsx)(le.rU,{to:"/dashboard/user/list",children:" User list"})},"3x")]})}var de=function(e){var n=(0,C.useState)(""),a=(0,d.Z)(n,2),t=a[0],i=a[1],r=(0,V.a)(F,{variables:{where:{id:1}}}),l=r.data,s=r.loading,o=r.error;return(0,C.useEffect)((function(){l&&i("group")}),[l]),o?(0,G.jsx)(D.default,{}):s||!t?(0,G.jsx)("div",{className:"center-screen",children:(0,G.jsx)(u.Z,{size:"large"})}):(0,G.jsxs)("div",{className:oe,children:[(0,G.jsxs)("div",{className:"add-role",children:[(0,G.jsx)(h.Z.Title,{level:3,children:"Add Role"}),(0,G.jsx)(x.Z,{direction:"vertical",style:{marginBottom:10},children:(0,G.jsx)(p.Z,{placeholder:"Basic usage"})})]}),(0,G.jsxs)(f.Z,{children:[(0,G.jsx)(v.Z,{span:6,children:(0,G.jsx)("div",{className:ce,children:(0,G.jsx)(j.Z,{size:"small",title:(0,G.jsx)(h.Z.Title,{level:4,children:"Resource"}),bodyStyle:{height:"calc(100vh - 100px - 20px - 48px - 48px - 45px)"},children:(0,G.jsx)(m(),{children:(0,G.jsx)(se,{setCurrentResource:i})})})})}),(0,G.jsx)(v.Z,{span:18,children:(0,G.jsx)(H,{currentResource:t,roleId:l.role.id})})]}),(0,G.jsxs)(g.$_,{style:{textAlign:"center",position:"sticky",bottom:0,height:48,padding:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,G.jsx)(y.Z,{danger:!0,children:" Cancel"}),(0,G.jsx)(y.Z,{type:"primary",children:"Save"})]})]})},oe=(0,o.iv)(Y||(Y=(0,s.Z)(["\n  max-height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  & .add-role {\n    height: 100px;\n  }\n  & .ant-row {\n    height: 100%;\n  }\n"]))),ce=(0,o.iv)(_||(_=(0,s.Z)(["\n  & .ant-card-body {\n    padding-right: 0;\n  }\n"])))},41673:function(e,n,a){a.r(n);var t,i=a(33028),r=a(96234),l=a(71171),s=a(66204),d=a(26567),o=a(53344),c=a(95865),m=a(48722),u=a(71580),h=a(72437),x=a(43188),p=((0,u.iv)(t||(t=(0,l.Z)(["\n  display: flex;\n  align-items: center;\n  & div>p {\n    margin\n  }\n"]))),[{title:"User",key:"user",width:150,ellipsis:!0,render:function(e,n){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(d.C,{src:n.avatar(),style:{marginRight:10}}),n.name]})}},{title:"Email",key:"email",dataIndex:"email",width:150,ellipsis:!0},{title:"Email",key:"email",dataIndex:"email",width:150,ellipsis:!0,responsive:["md","sm"]},{title:"Email",key:"email",dataIndex:"email",width:150,responsive:["md","sm"],ellipsis:!0},{title:"Email",key:"email",dataIndex:"email",width:150,ellipsis:!0,responsive:["md","sm"]},{title:"Email",key:"email",dataIndex:"email",width:150,responsive:["md","sm"],ellipsis:!0},{width:80,ellipsis:!0,title:"Status",key:"status",dataIndex:"status",responsive:["sm"]},{title:"Role",key:"role",width:200,dataIndex:"roles",render:function(e){return(0,x.jsx)(j,{roles:e})}},{title:"Group",key:"group",width:100,dataIndex:"group",render:function(e){return(0,x.jsx)("a",{children:e})}}]),f=[{key:"1",name:"John Brown",email:"hello@gmail.comddfdfsfsdf",age:32,address:"New York No. 1 Lake Park",roles:["admin","user"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"2",name:"Jim Greendsfsdfsdfssdfsdfddsfsdf",email:"hello@gmail.com",age:42,address:"London No. 1 Lake Park",roles:["admin","editor"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"3",name:"Joe Black",email:"hello@gmail.com",age:32,address:"Sidney No. 1 Lake Park",roles:["admin"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"4",name:"Disabled User",email:"hello@gmail.com",age:99,address:"Sidney No. 1 Lake Park",roles:["admin"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"11",name:"John Brown",email:"hello@gmail.com",age:32,address:"New York No. 1 Lake Park",roles:["admin","user"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"12",name:"Jim Green",email:"hello@gmail.com",age:42,address:"London No. 1 Lake Park",roles:["admin","editor"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"13",name:"Joe Black",email:"hello@gmail.com",age:32,address:"Sidney No. 1 Lake Park",roles:["admin"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"14",name:"Disabled User",email:"hello@gmail.com",age:99,address:"Sidney No. 1 Lake Park",roles:["admin"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"111",name:"John Brown",email:"hello@gmail.com",age:32,address:"New York No. 1 Lake Park",roles:["admin","user"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"112",name:"Jim Green",email:"hello@gmail.com",age:42,address:"London No. 1 Lake Park",roles:["admin","editor"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"113",name:"Joe Black",email:"hello@gmail.com",age:32,address:"Sidney No. 1 Lake Park",roles:["admin"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}},{key:"114",name:"Disabled User",email:"hello@gmail.com",age:99,address:"Sidney No. 1 Lake Park",roles:["admin"],avatar:function(){return"https://pixinvent.com/demo/vuexy-vuejs-laravel-admin-template/demo-1/images/avatars/".concat(this.key,".png")}}],v=[{label:"Admin",value:"admin"},{label:"User",value:"user"},{label:"Editor",value:"editor"}],j=function(e){var n=e.roles;return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(o.Z,{mode:"multiple",style:{width:"100%"},defaultValue:n,options:v,onChange:function(e){},placeholder:"Select Item...",maxTagCount:"responsive"})})},y={getCheckboxProps:function(e){return{disabled:"Disabled User"===e.name,name:e.name}}};n.default=function(){var e=(0,s.useState)("checkbox"),n=(0,r.Z)(e,2),a=n[0],t=n[1],l=(0,h.Gc)(),d=(0,s.useMemo)((function(){return p.reduce((function(e,n){var a;return null!==n&&void 0!==n&&null!==(a=n.responsive)&&void 0!==a&&a.includes(l)?(console.log(e+n.width||100),e+n.width||100):e}),0)}),[l]);return(0,x.jsxs)("div",{children:[(0,x.jsxs)(c.ZP.Group,{onChange:function(e){var n=e.target.value;t(n)},value:a,style:{marginBottom:10},children:[(0,x.jsx)(c.ZP,{value:"checkbox",children:"Checkbox"}),(0,x.jsx)(c.ZP,{value:"radio",children:"radio"})]}),(0,x.jsx)("p",{children:"h"}),(0,x.jsx)("p",{children:"h"}),(0,x.jsx)("p",{children:"h"}),(0,x.jsx)("p",{children:"h"}),(0,x.jsx)(m.Z,{rowSelection:(0,i.Z)({type:a},y),size:"small",columns:p,dataSource:f,scroll:{y:450,x:d}})]})}}}]);
//# sourceMappingURL=role.list.be4361da.chunk.js.map